<!DOCTYPE html>
<html lang="en-US">
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146468244-1"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'UA-146468244-1');
		</script>
		
		<title>How to get files used with "Open With" on a Mac in Java?</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta charset="utf-8" />
		<meta name="Description" content="Use Java source code to access files that are used with the Mac operating system's context menu open with command" />
		<style type="text/css">
			a { color: rgb(0, 0, 255); }
			
			.blue
			{
				color: rgb(0, 0, 255);
				display: inline;
			}
			
			body
			{
				box-sizing: border-box;
				font-family: sans-serif;
				font-size: 1em;
			}
			
			.center
			{
				display: inline-block;
				text-align: center;
				width: 100%;
			}
			
			code { font-size: 1.10em; }
			
			#content
			{
				margin: auto;
				width: 800px;
			}
			
			#copyright
			{
				font-size: 0.75em;
				text-align: center;
				margin: auto;
				margin-top: 1em;
				width: 800px;
			}
			
			.FileName
			{
				background-color: rgb(200, 200, 200);
				display: inline-block;
				font-weight: bold;
				margin-bottom: 0;
				width: 100%;
			}
			
			h1
			{
				font-size: 1.5em;
				font-weight: bold;
				text-align: center;
				width: 100%;
			}
			
			h2
			{
				font-size: 1em;
				font-weight: bold;
				display: inline;
			}
			
			pre
			{
				background-color: rgb(225, 225, 225);
				display: inline-block;
				margin: 0;
				width: 100%;
			}
			
			.red
			{
				color: rgb(255, 0, 0);
				display: inline;
			}
		</style>
	</head>
	<body>
		<div id="content">
			<h1>How to get files used with "Open With" on a Mac in Java?</h1>
			<h2>Step 1: Add an OpenFileHandler</h2> Start by creating and setting an <code>OpenFileHandler</code> using <code>Desktop.getDesktop().setOpenFileHandler()</code>.<br /><br />
			
			<div class="FileName">FileHandler.java</div><pre>import java.awt.desktop.OpenFilesEvent;
import java.awt.desktop.OpenFilesHandler;

public class <div class="blue">FileHandler</div> implements OpenFilesHandler
{
	...
	
	public void openFiles (OpenFilesEvent e)
	{
		// Do something with the files using e.getFiles().
		...
	}
	
	...
}</pre><br /><br />
			
			
			<div class="FileName">SampleProgram.java</div><pre>import java.awt.Desktop;

public class SampleProgram
{
	public static void main (String[] args)
	{
		...
		
		<div class="blue">FileHandler</div> fh = new <div class="blue">FileHandler</div>();
		<div class="red">Desktop.getDesktop().setOpenFileHandler(fh);</div>
		
		...
	}
}</pre><br /><br />

<h2>Step 2: Compile </h2> Compile your source code into a <code>.app</code> executable. At the terminal execute:<br />
			<code>javapackager -makeall -appclass SampleProgram</code><br /><br />
			
			<h2>Step 3: Modify Info.plist </h2> You must modify your application's <code>Info.plist</code> and add a key for each file type you want your application to modify. To do this, right click on your <code>.app</code> executable and select "Show Package Contents".<br /><br />
			
			<div class="center"><img src="ShowPackageContents.png" alt="Screenshot of the 'Show Package Contents' context menu item when you right click a .app file." /></div><br /><br />
			
			Navigate to <code>/Contents/</code> and open <code>Info.plist</code> with a text editor. At the end of this file, add a <code>CFBundleDocumentTypes</code> key and an array holding each of the file types you want your application to be able to open. For more information, see the Apple Developer's documentation for <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/TP40009249-101685-TPXREF107" target="_blank" rel="noreferrer">CFBundleDocumentTypes</a>, <a href="https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/understanding_utis/understand_utis_intro/understand_utis_intro.html#//apple_ref/doc/uid/TP40001319" target="_blank" rel="noreferrer">Uniform Type Identifiers</a>, and <a href="https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html#//apple_ref/doc/uid/TP40009259" target="_blank" rel="noreferrer">System-Declared Uniform Type Identifiers</a>.<br /><br />
			
			Because I want my application to read text (<code>.txt</code>) and HTML (<code>.htm</code>, <code>.html</code>) files, my application's <code>Info.plist</code> looks like:<br /><br />
			<div class="FileName">Info.plist</div><pre>&lt;?xml version="1.0" ?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
	&lt;dict&gt;
		&lt;key&gt;LSMinimumSystemVersion&lt;/key&gt;
		&lt;string&gt;10.9&lt;/string&gt;
		&lt;key&gt;CFBundleDevelopmentRegion&lt;/key&gt;
		&lt;string&gt;English&lt;/string&gt;
		...
		&lt;key&gt;CFBundleDocumentTypes&lt;/key&gt;
		&lt;array&gt;
			&lt;dict&gt;
				&lt;key&gt;CFBundleTypeExtensions&lt;/key&gt;
				&lt;array&gt;
					&lt;string&gt;<div class="red">txt</div>&lt;/string&gt;
				&lt;/array&gt;
				&lt;key&gt;CFBundleTypeRole&lt;/key&gt;
				&lt;string&gt;Editor&lt;/string&gt;
				&lt;key&gt;LSItemContentTypes&lt;/key&gt;
				&lt;array&gt;
					&lt;string&gt;<div class="red">public.plain-text</div>&lt;/string&gt;
				&lt;/array&gt;
			&lt;/dict&gt;
			&lt;dict&gt;
				&lt;key&gt;CFBundleTypeExtensions&lt;/key&gt;
				&lt;array&gt;
					&lt;string&gt;<div class="red">htm</div>&lt;/string&gt;
				&lt;/array&gt;
				&lt;key&gt;CFBundleTypeRole&lt;/key&gt;
				&lt;string&gt;Editor&lt;/string&gt;
				&lt;key&gt;LSItemContentTypes&lt;/key&gt;
				&lt;array&gt;
					&lt;string&gt;<div class="red">public.html</div>&lt;/string&gt;
				&lt;/array&gt;
			&lt;/dict&gt;
			&lt;dict&gt;
				&lt;key&gt;CFBundleTypeExtensions&lt;/key&gt;
				&lt;array&gt;
					&lt;string&gt;<div class="red">html</div>&lt;/string&gt;
				&lt;/array&gt;
				&lt;key&gt;CFBundleTypeRole&lt;/key&gt;
				&lt;string&gt;Editor&lt;/string&gt;
				&lt;key&gt;LSItemContentTypes&lt;/key&gt;
				&lt;array&gt;
					&lt;string&gt;<div class="red">public.html</div>&lt;/string&gt;
				&lt;/array&gt;
			&lt;/dict&gt;
		&lt;/array&gt;
	&lt;/dict&gt;
&lt;/plist&gt;</pre><br /><br />

			Don't forget to save the modified <code>Info.plist</code>!<br /><br />
			
			<h2>Step 5: Open With</h2> Now you can open files with the system's context menu item "Open With". The file or files used with "Open With" can be accessed with the  <code>OpenFilesEvent.getFiles()</code> method.<br /><br />
			
			<div class="center">Right click the file you want to edit. Select Open With &rarr; Other.<br /><img src="OpenWith_Other.png" alt="Screenshot of the 'Open With' context menu item when you right click a .txt file." /></div><br /><br />
			
			<div class="center">Navigate to where your <code>.app</code> is stored. Select it, then click Open.<br /><img src="OpenWith_Choose.png" alt="Screenshot of the 'Open With' window with our application selected to open the .txt file with." /></div><br /><br />
			
			<div class="center">The file was successfully passed into our program.<br /><img src="OpenedFile.png" alt="Screenshot of our application displaying the full directory of our .txt file." /></div><br /><br />
			
			Download the <a href="OpenWith_src.zip" target="_blank">source code</a>.
		</div>
		<div id="copyright">Written by William Jenkins (billbilljr [at] gmail [dot] com).<br />August 24, 2019</div>
	</body>
</html>